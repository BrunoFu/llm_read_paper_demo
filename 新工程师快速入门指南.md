# æ–°å·¥ç¨‹å¸ˆå¿«é€Ÿå…¥é—¨æŒ‡å—

## ğŸš€ 5åˆ†é’Ÿå¿«é€Ÿä½“éªŒ

### 1. ç¯å¢ƒå‡†å¤‡
```bash
# å…‹éš†é¡¹ç›®ï¼ˆå¦‚æœéœ€è¦ï¼‰
cd /Users/fro/Library/CloudStorage/OneDrive-ä¸ªäºº/code/OCR_api_test

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# æ£€æŸ¥ä¾èµ–
python check_fsz_dependencies.py
```

### 2. ğŸ¯ **æœ€ä½³ä½“éªŒï¼šä½¿ç”¨å°è£…çš„æµæ°´çº¿**
```python
# åˆ›å»ºæµ‹è¯•æ–‡ä»¶ test_pipeline.py
import asyncio
from tools.paper_processing_service import process_paper_pipeline

async def main():
    result = await process_paper_pipeline("example_pdfs/sample.pdf")

    if result.success:
        print(f"âœ… å¤„ç†æˆåŠŸï¼")
        print(f"ğŸ“„ æœ€ç»ˆæŠ¥å‘Š: {result.final_report_path}")
        print(f"â±ï¸ å¤„ç†è€—æ—¶: {result.total_processing_time:.2f}ç§’")
    else:
        print(f"âŒ å¤„ç†å¤±è´¥: {result.pipeline_error}")

asyncio.run(main())
```

```bash
# è¿è¡Œæµ‹è¯•
python test_pipeline.py
```

### 3. æŸ¥çœ‹è¯¦ç»†ç¤ºä¾‹
```bash
# è¿è¡Œå®˜æ–¹ç¤ºä¾‹ï¼ˆåŒ…å«å¤šç§ä½¿ç”¨åœºæ™¯ï¼‰
python tools/example_usage.py
```

### 4. Webç•Œé¢ä½“éªŒ
```bash
cd frontend
python app.py
# æ‰“å¼€æµè§ˆå™¨è®¿é—® http://localhost:7860
```

### 5. ä¼ ç»Ÿæ–¹å¼ï¼ˆä¸æ¨èæ–°æ‰‹ï¼‰
```bash
# ä½¿ç”¨main.pyè¿›è¡ŒåŸºç¡€æµ‹è¯•ï¼ˆä¸»è¦ç”¨äºæ•°æ®åº“ç®¡ç†ï¼‰
python main.py example_pdfs/sample.pdf --basic

# æŸ¥çœ‹ç»“æœ
ls output/sample/
```

## ğŸ“ æ ¸å¿ƒæ–‡ä»¶å¿«é€Ÿå®šä½

### ğŸ¯ **æœ€é‡è¦ï¼šé¡¹ç›®æ ¸å¿ƒå°è£…**
- **ğŸŒŸ æ ¸å¿ƒå…¥å£**ï¼š`tools/paper_processing_service.py` - å®Œæ•´å››é˜¶æ®µæµæ°´çº¿å°è£…
- **ğŸ“‹ æ•°æ®æ¨¡å‹**ï¼š`tools/pipeline_models.py` - PipelineConfigã€PipelineResultç­‰
- **ğŸ“– ä½¿ç”¨ç¤ºä¾‹**ï¼š`tools/example_usage.py` - è¯¦ç»†çš„ä½¿ç”¨ç¤ºä¾‹å’Œæœ€ä½³å®è·µ
- **ğŸ§ª æµ‹è¯•è„šæœ¬**ï¼š`tools/test_pipeline_service.py` - å®Œæ•´æµ‹è¯•

### æƒ³äº†è§£æ•´ä½“æµç¨‹ï¼Ÿ
- **æ‰¹é‡å¤„ç†**ï¼š`run_fsz_batch_processing.py` - æ‰¹é‡å¤„ç†å…¥å£
- **Webç•Œé¢**ï¼š`frontend/app.py` - ç”¨æˆ·ç•Œé¢
- **æ•°æ®åº“ç®¡ç†**ï¼š`main.py` - ç®€åŒ–ç‰ˆå•æ–‡ä»¶å¤„ç†ï¼ˆä¸»è¦ç”¨äºæ•°æ®åº“æ“ä½œï¼‰

### æƒ³äº†è§£å„ä¸ªé˜¶æ®µï¼Ÿ
1. **é˜¶æ®µ1**ï¼š`crop_pdf_first_three_page/ocr_processor_mineru.py`
2. **é˜¶æ®µ2**ï¼š`pdf_content_extractor/pdf_ocr.py`
3. **é˜¶æ®µ3**ï¼š`section_data_extractor/extract_sections.py`
4. **é˜¶æ®µ4**ï¼š`report_generator/report_processor.py`

### æƒ³äº†è§£æ•°æ®ç»“æ„ï¼Ÿ
- **æµæ°´çº¿æ¨¡å‹**ï¼š`tools/pipeline_models.py` - ç°ä»£åŒ–çš„æ•°æ®ç»“æ„
- **æ•°æ®åº“æ¨¡å‹**ï¼š`database/models.py` - ä¼ ç»Ÿæ•°æ®åº“æ¨¡å‹
- **æ•°æ®åº“æ“ä½œ**ï¼š`database/db_manager.py`
- **é…ç½®ç®¡ç†**ï¼š`config.py` å’Œ `utils/llm_config.py`

## ğŸ”§ å¸¸è§ä¿®æ”¹åœºæ™¯

### ğŸ¯ **æ¨èï¼šåŸºäºå°è£…æœåŠ¡è¿›è¡Œå®šåˆ¶**
**ä¿®æ”¹ä½ç½®**ï¼š`tools/paper_processing_service.py` æˆ–åˆ›å»ºè‡ªå®šä¹‰æœåŠ¡
```python
from tools.paper_processing_service import PaperProcessingService
from tools.pipeline_models import PipelineConfig

# åœºæ™¯1ï¼šè‡ªå®šä¹‰é…ç½®
config = PipelineConfig(
    output_dir="my_output",
    api_name="custom_api",
    llm_config={"temperature": 0.1},
    max_retry_attempts=5
)

# åœºæ™¯2ï¼šè‡ªå®šä¹‰è¿›åº¦ç›‘æ§
def my_progress_callback(progress_info):
    # ä½ çš„è¿›åº¦å¤„ç†é€»è¾‘
    print(f"è¿›åº¦: {progress_info.overall_progress:.1%}")

# åœºæ™¯3ï¼šè‡ªå®šä¹‰é”™è¯¯å¤„ç†
def my_error_callback(stage, error):
    # ä½ çš„é”™è¯¯å¤„ç†é€»è¾‘
    print(f"é˜¶æ®µ {stage.value} å‡ºé”™: {error}")

# ä½¿ç”¨è‡ªå®šä¹‰é…ç½®
result = await process_paper_pipeline(
    pdf_path="your_paper.pdf",
    config=config,
    progress_callback=my_progress_callback,
    error_callback=my_error_callback
)
```

### ä¼ ç»Ÿä¿®æ”¹æ–¹å¼

### åœºæ™¯1ï¼šæ·»åŠ æ–°çš„OCRæœåŠ¡
**ä¿®æ”¹ä½ç½®**ï¼š`pdf_content_extractor/`
```python
# åœ¨ pdf_ocr.py ä¸­æ·»åŠ æ–°çš„OCRå®ç°
class NewOCRService:
    def process_pdf(self, pdf_path):
        # ä½ çš„OCRé€»è¾‘
        pass
```

### åœºæ™¯2ï¼šä¿®æ”¹å…ƒæ•°æ®æå–é€»è¾‘
**ä¿®æ”¹ä½ç½®**ï¼š`tools/enhanced_metadata_extractor.py`
```python
# ä¿®æ”¹å…ƒæ•°æ®æå–å‡½æ•°
def extract_metadata_from_pdf(pdf_path, first_pages_path, template_path):
    # ä½ çš„æå–é€»è¾‘
    pass
```

### åœºæ™¯3ï¼šè‡ªå®šä¹‰æŠ¥å‘Šæ ¼å¼
**ä¿®æ”¹ä½ç½®**ï¼š`report_generator/`
```python
# æ·»åŠ æ–°çš„æŠ¥å‘Šç”Ÿæˆå™¨
class CustomReportGenerator:
    def generate_report(self, data):
        # ä½ çš„æŠ¥å‘Šç”Ÿæˆé€»è¾‘
        pass
```

### åœºæ™¯4ï¼šä¿®æ”¹Webç•Œé¢
**ä¿®æ”¹ä½ç½®**ï¼š`frontend/app.py`
```python
# ä¿®æ”¹Gradioç•Œé¢
def create_interface():
    # ä½ çš„ç•Œé¢å®šåˆ¶
    pass
```

## ğŸ› å¸¸è§é—®é¢˜è§£å†³

### é—®é¢˜1ï¼šAPIå¯†é’¥é…ç½®
```python
# åœ¨ utils/llm_config.py ä¸­é…ç½®
LLM_CONFIG = {
    "openai": {
        "api_key": "your-openai-key"
    },
    "mistral": {
        "api_key": "your-mistral-key"
    }
}
```

### é—®é¢˜2ï¼šä¾èµ–å®‰è£…å¤±è´¥
```bash
# ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒ
python -m venv venv
source venv/bin/activate  # Linux/Mac
# æˆ– venv\Scripts\activate  # Windows

pip install -r requirements.txt
```

### é—®é¢˜3ï¼šå¤„ç†å¤±è´¥
```bash
# æŸ¥çœ‹æ—¥å¿—
tail -f logs/ocr_api.log
tail -f logs/batch_process_fsz.log
```

## ğŸ“Š æµ‹è¯•æ•°æ®ä½ç½®

### ç¤ºä¾‹PDFæ–‡ä»¶
- `example_pdfs/` - æµ‹è¯•ç”¨çš„PDFæ–‡ä»¶
- `fsz_ra_papers/` - ç½—æ–¯ç¦æ–°æ”¿ç›¸å…³æ–‡çŒ®
- `original_database/` - åŸå§‹æ•°æ®åº“æ–‡ä»¶

### è¾“å‡ºç»“æœ
- `output/` - å•æ–‡ä»¶å¤„ç†ç»“æœ
- `results/` - æ‰¹é‡å¤„ç†ç»“æœ
- `logs/` - ç³»ç»Ÿæ—¥å¿—

## ğŸ¯ å­¦ä¹ è·¯å¾„å»ºè®®

### ç¬¬1å¤©ï¼šç†è§£æ•´ä½“æ¶æ„
1. é˜…è¯» `README.md` å’Œ `tools/README_pipeline_encapsulation.md`
2. ğŸ¯ **é‡ç‚¹**ï¼šè¿è¡Œ `python tools/example_usage.py` æŸ¥çœ‹å®Œæ•´ç¤ºä¾‹
3. æŸ¥çœ‹è¾“å‡ºç»“æœç»“æ„

### ç¬¬2å¤©ï¼šæ·±å…¥æ ¸å¿ƒæ¨¡å—
1. ğŸ¯ **é‡ç‚¹**ï¼šç ”ç©¶ `tools/paper_processing_service.py` çš„å°è£…é€»è¾‘
2. äº†è§£ `tools/pipeline_models.py` çš„æ•°æ®ç»“æ„
3. äº†è§£å››ä¸ªé˜¶æ®µçš„å…·ä½“å®ç°
4. æŸ¥çœ‹æ•°æ®åº“ç»“æ„ï¼ˆå¯é€‰ï¼‰

### ç¬¬3å¤©ï¼šå®è·µä¿®æ”¹
1. ğŸ¯ **æ¨è**ï¼šåŸºäºå°è£…æœåŠ¡è¿›è¡Œè‡ªå®šä¹‰é…ç½®
2. å°è¯•ä¿®æ”¹è¿›åº¦å›è°ƒæˆ–é”™è¯¯å¤„ç†
3. è¿è¡Œæµ‹è¯•éªŒè¯ä¿®æ”¹
4. æŸ¥çœ‹æ—¥å¿—æ’æŸ¥é—®é¢˜

### ç¬¬4å¤©ï¼šæ‰©å±•å¼€å‘
1. æ·»åŠ è‡ªå®šä¹‰åŠŸèƒ½åˆ°æµæ°´çº¿
2. é›†æˆæ–°çš„APIæœåŠ¡
3. ä¼˜åŒ–å¤„ç†æ€§èƒ½
4. åˆ›å»ºè‡ªå·±çš„æ‰¹é‡å¤„ç†è„šæœ¬

## ğŸ” è°ƒè¯•æŠ€å·§

### 1. å¯ç”¨è¯¦ç»†æ—¥å¿—
```python
import logging
logging.basicConfig(level=logging.DEBUG)
```

### 2. å•æ­¥è°ƒè¯•
```python
# åœ¨å…³é”®ä½ç½®æ·»åŠ æ–­ç‚¹
import pdb; pdb.set_trace()
```

### 3. æŸ¥çœ‹ä¸­é—´ç»“æœ
```python
# ä¿å­˜ä¸­é—´å¤„ç†ç»“æœ
with open("debug_output.json", "w") as f:
    json.dump(intermediate_data, f, indent=2)
```

## ğŸ“ è·å–å¸®åŠ©

### æŸ¥çœ‹æ–‡æ¡£
- `README.md` - é¡¹ç›®æ€»ä½“è¯´æ˜
- `é¡¹ç›®åŠŸèƒ½åˆ†ææŠ¥å‘Š.md` - è¯¦ç»†æŠ€æœ¯æ–‡æ¡£
- å„æ¨¡å—çš„ `README_*.md` - æ¨¡å—è¯´æ˜

### æŸ¥çœ‹ç¤ºä¾‹
- `tools/example_usage.py` - ä½¿ç”¨ç¤ºä¾‹
- `tools/demo_pipeline.py` - æµæ°´çº¿æ¼”ç¤º
- `frontend/test_*.py` - æµ‹è¯•ç¤ºä¾‹

### æ£€æŸ¥é…ç½®
- `config.py` - åŸºç¡€é…ç½®
- `utils/llm_config.py` - LLMé…ç½®
- `requirements.txt` - ä¾èµ–åˆ—è¡¨

---

**ä½œä¸º Claude 4.0 Opus**ï¼Œæˆ‘å»ºè®®æ–°å·¥ç¨‹å¸ˆæŒ‰ç…§è¿™ä¸ªæŒ‡å—å¾ªåºæ¸è¿›åœ°å­¦ä¹ ï¼Œå…ˆç†è§£æ•´ä½“æ¶æ„ï¼Œå†æ·±å…¥å…·ä½“æ¨¡å—ï¼Œæœ€åè¿›è¡Œå®è·µå¼€å‘ã€‚é‡åˆ°é—®é¢˜æ—¶ï¼Œä¼˜å…ˆæŸ¥çœ‹æ—¥å¿—å’Œæ–‡æ¡£ï¼Œå¿…è¦æ—¶å¯ä»¥æ·»åŠ è°ƒè¯•ä»£ç æ¥ç†è§£ç¨‹åºæ‰§è¡Œæµç¨‹ã€‚
